<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Trading App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'dark-bg': '#0f172a',
                        'dark-card': '#1e293b',
                        'dark-border': '#334155',
                        'accent-cyan': '#06b6d4',
                        'accent-blue': '#3b82f6',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .module-hidden { display: none !important; }
        .nav-active { background-color: #06b6d4; color: white; }
    </style>
</head>
<body class="bg-dark-bg text-white">

<!-- Auth Modal -->
<div id="auth-modal" class="fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50">
    <div class="bg-dark-card border border-dark-border rounded-2xl p-8 max-w-md w-full mx-4">
        <div class="flex items-center gap-3 mb-6">
            <div class="bg-accent-cyan p-2 rounded-lg">
                <span class="material-symbols-outlined text-2xl">account_circle</span>
            </div>
            <h2 class="text-2xl font-bold">AI Trading App</h2>
        </div>

        <!-- Tabs -->
        <div class="flex mb-6 bg-dark-bg rounded-lg p-1">
            <button id="tab-login" onclick="switchAuthTab('login')" class="flex-1 py-2 px-4 rounded-md bg-accent-cyan text-white font-medium transition">
                Iniciar Sesión
            </button>
            <button id="tab-register" onclick="switchAuthTab('register')" class="flex-1 py-2 px-4 rounded-md text-gray-400 font-medium transition hover:text-white">
                Registrarse
            </button>
        </div>

        <!-- Login Form -->
        <div id="form-login" class="space-y-4">
            <div>
                <label class="text-gray-300 text-sm font-medium block mb-2">Usuario o Email</label>
                <input id="login-username" type="text" placeholder="Ingresa tu usuario o email" class="w-full bg-dark-bg text-white rounded-lg px-4 py-3 border border-dark-border focus:border-accent-cyan focus:outline-none transition"/>
            </div>
            <div>
                <label class="text-gray-300 text-sm font-medium block mb-2">Contraseña</label>
                <input id="login-password" type="password" placeholder="Ingresa tu contraseña" class="w-full bg-dark-bg text-white rounded-lg px-4 py-3 border border-dark-border focus:border-accent-cyan focus:outline-none transition"/>
            </div>
            <div class="flex justify-end">
                <button onclick="showForgotPassword()" class="text-sm text-accent-cyan hover:text-cyan-400 transition">
                    ¿Olvidaste tu contraseña?
                </button>
            </div>
            <button onclick="loginUser()" class="w-full bg-accent-cyan hover:bg-cyan-600 text-white font-bold py-3 px-4 rounded-lg transition">
                Iniciar Sesión
            </button>
            <div id="login-message" class="text-sm text-center hidden"></div>
        </div>

        <!-- Register Form -->
        <div id="form-register" class="space-y-4 hidden">
            <div>
                <label class="text-gray-300 text-sm font-medium block mb-2">Nombre de Usuario</label>
                <input id="register-username" type="text" placeholder="Elige un nombre de usuario" class="w-full bg-dark-bg text-white rounded-lg px-4 py-3 border border-dark-border focus:border-accent-cyan focus:outline-none transition"/>
            </div>
            <div>
                <label class="text-gray-300 text-sm font-medium block mb-2">Email</label>
                <input id="register-email" type="email" placeholder="tu@email.com" class="w-full bg-dark-bg text-white rounded-lg px-4 py-3 border border-dark-border focus:border-accent-cyan focus:outline-none transition"/>
            </div>
            <div>
                <label class="text-gray-300 text-sm font-medium block mb-2">Contraseña</label>
                <input id="register-password" type="password" placeholder="Mínimo 8 caracteres" class="w-full bg-dark-bg text-white rounded-lg px-4 py-3 border border-dark-border focus:border-accent-cyan focus:outline-none transition"/>
            </div>
            <div>
                <label class="text-gray-300 text-sm font-medium block mb-2">Confirmar Contraseña</label>
                <input id="register-confirm-password" type="password" placeholder="Repite tu contraseña" class="w-full bg-dark-bg text-white rounded-lg px-4 py-3 border border-dark-border focus:border-accent-cyan focus:outline-none transition"/>
            </div>
            <button onclick="registerUser()" class="w-full bg-accent-cyan hover:bg-cyan-600 text-white font-bold py-3 px-4 rounded-lg transition">
                Crear Cuenta
            </button>
            <div id="register-message" class="text-sm text-center hidden"></div>
        </div>

        <!-- Forgot Password Form -->
        <div id="form-forgot-password" class="space-y-4 hidden">
            <div class="flex items-center gap-2 mb-4">
                <button onclick="switchAuthTab('login')" class="text-gray-400 hover:text-white">
                    <span class="material-symbols-outlined">arrow_back</span>
                </button>
                <h3 class="text-lg font-semibold">Recuperar Contraseña</h3>
            </div>
            <p class="text-sm text-gray-400 mb-4">Ingresa tu email y te enviaremos un código de verificación.</p>
            <div>
                <label class="text-gray-300 text-sm font-medium block mb-2">Email</label>
                <input id="forgot-email" type="email" placeholder="tu@email.com" class="w-full bg-dark-bg text-white rounded-lg px-4 py-3 border border-dark-border focus:border-accent-cyan focus:outline-none transition"/>
            </div>
            <button onclick="sendRecoveryCode()" class="w-full bg-accent-cyan hover:bg-cyan-600 text-white font-bold py-3 px-4 rounded-lg transition">
                Enviar Código
            </button>
            <div id="forgot-message" class="text-sm text-center hidden"></div>
        </div>
    </div>
</div>

<!-- Main App -->
<div id="main-app" class="hidden min-h-screen">
    <!-- Top Header -->
    <header class="bg-[#1a1f2e] border-b border-dark-border sticky top-0 z-50">
        <div class="px-8 py-4 flex items-center justify-between">
            <!-- Logo and Title -->
            <div class="flex items-center gap-3">
                <div class="bg-accent-cyan p-2 rounded-lg">
                    <span class="material-symbols-outlined text-xl">database</span>
                </div>
                <h1 class="text-xl font-bold">AI Trading App</h1>
            </div>

            <!-- Navigation Tabs -->
            <nav class="flex gap-1">
                <button onclick="showModule('dashboard')" class="nav-tab px-6 py-2 rounded-t-lg font-medium transition nav-active" data-module="dashboard">
                    Dashboard
                </button>
                <button onclick="showModule('bot')" class="nav-tab px-6 py-2 rounded-t-lg font-medium text-gray-400 hover:text-white transition" data-module="bot">
                    Bot
                </button>
                <button onclick="showModule('backtest')" class="nav-tab px-6 py-2 rounded-t-lg font-medium text-gray-400 hover:text-white transition" data-module="backtest">
                    Backtest
                </button>
                <button onclick="showModule('config')" class="nav-tab px-6 py-2 rounded-t-lg font-medium text-gray-400 hover:text-white transition" data-module="config">
                    Configuración
                </button>
            </nav>

            <!-- Right Side: Connection Status + ID + Avatar -->
            <div class="flex items-center gap-4">
                <div class="flex items-center gap-2">
                    <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                    <span class="text-sm text-gray-300">Conectado a Topstepx</span>
                </div>
                <span class="text-sm text-gray-400">ID: <span id="account-id" class="text-gray-300">-</span></span>
                <button class="text-gray-400 hover:text-white">
                    <span class="material-symbols-outlined">notifications</span>
                </button>
                <div class="w-10 h-10 bg-gradient-to-br from-orange-400 to-pink-400 rounded-full"></div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="p-8">
        <!-- Dashboard Module -->
        <div id="module-dashboard" class="module-visible">
            <!-- Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="bg-dark-card border border-dark-border rounded-xl p-6">
                    <p class="text-gray-400 text-sm mb-2">Saldo de la Cuenta</p>
                    <p id="balance" class="text-3xl font-bold">$150,432.10</p>
                </div>
                <div class="bg-dark-card border border-dark-border rounded-xl p-6">
                    <p class="text-gray-400 text-sm mb-2">Ganancias del Día</p>
                    <p id="daily-pnl" class="text-3xl font-bold text-green-500">$1,250.75</p>
                </div>
                <div class="bg-dark-card border border-dark-border rounded-xl p-6">
                    <p class="text-gray-400 text-sm mb-2">Win Rate</p>
                    <p id="win-rate" class="text-3xl font-bold">68%</p>
                </div>
                <div class="bg-dark-card border border-dark-border rounded-xl p-6">
                    <p class="text-gray-400 text-sm mb-2">Max Drawdown</p>
                    <p id="max-drawdown" class="text-3xl font-bold text-red-500">-$4,120.50</p>
                </div>
            </div>

            <!-- Active Positions -->
            <div class="bg-dark-card border border-dark-border rounded-xl p-6 mb-8">
                <h2 class="text-2xl font-bold mb-6">Traders Activos</h2>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="text-left text-gray-400 text-sm border-b border-dark-border">
                                <th class="pb-4 font-medium">Symbol</th>
                                <th class="pb-4 font-medium">Quantity</th>
                                <th class="pb-4 font-medium">Entry Price</th>
                                <th class="pb-4 font-medium">Current Price</th>
                                <th class="pb-4 font-medium">P&L</th>
                                <th class="pb-4 font-medium">Action</th>
                            </tr>
                        </thead>
                        <tbody id="positions-table" class="text-sm">
                            <tr>
                                <td colspan="6" class="py-8 text-center text-gray-400">Cargando posiciones...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Trade History -->
            <div class="bg-dark-card border border-dark-border rounded-xl p-6">
                <h2 class="text-2xl font-bold mb-6">Historial de Traders Realizados</h2>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="text-left text-gray-400 text-sm border-b border-dark-border">
                                <th class="pb-4 font-medium">Symbol</th>
                                <th class="pb-4 font-medium">Type</th>
                                <th class="pb-4 font-medium">Quantity</th>
                                <th class="pb-4 font-medium">Entry Price</th>
                                <th class="pb-4 font-medium">Close Price</th>
                                <th class="pb-4 font-medium">P&L</th>
                                <th class="pb-4 font-medium">Date</th>
                            </tr>
                        </thead>
                        <tbody id="history-table" class="text-sm">
                            <tr>
                                <td colspan="7" class="py-8 text-center text-gray-400">Cargando historial...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Bot Module -->
        <div id="module-bot" class="module-hidden">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Left Column -->
                <div class="space-y-6">
                    <!-- Trading Schedule -->
                    <div class="bg-dark-card border border-dark-border rounded-xl p-6">
                        <h3 class="text-xl font-bold mb-4">Horario y días de trading</h3>

                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="text-gray-400 text-sm block mb-2">Hora de inicio de búsqueda</label>
                                <div class="relative">
                                    <input type="time" id="start-time" value="09:30" class="w-full bg-dark-bg text-white rounded-lg px-4 py-2 border border-dark-border focus:border-accent-cyan focus:outline-none"/>
                                    <span class="material-symbols-outlined absolute right-3 top-2 text-gray-400">schedule</span>
                                </div>
                            </div>
                            <div>
                                <label class="text-gray-400 text-sm block mb-2">Hora de fin de búsqueda</label>
                                <div class="relative">
                                    <input type="time" id="end-time" value="16:00" class="w-full bg-dark-bg text-white rounded-lg px-4 py-2 border border-dark-border focus:border-accent-cyan focus:outline-none"/>
                                    <span class="material-symbols-outlined absolute right-3 top-2 text-gray-400">schedule</span>
                                </div>
                            </div>
                        </div>

                        <div>
                            <label class="text-gray-400 text-sm block mb-3">Días de trading</label>
                            <div class="flex gap-2">
                                <button class="w-12 h-12 rounded-lg bg-accent-cyan text-white font-semibold">L</button>
                                <button class="w-12 h-12 rounded-lg bg-accent-cyan text-white font-semibold">M</button>
                                <button class="w-12 h-12 rounded-lg bg-dark-bg text-gray-400 font-semibold hover:bg-dark-border transition">X</button>
                                <button class="w-12 h-12 rounded-lg bg-accent-cyan text-white font-semibold">J</button>
                                <button class="w-12 h-12 rounded-lg bg-accent-cyan text-white font-semibold">V</button>
                                <button class="w-12 h-12 rounded-lg bg-dark-bg text-gray-400 font-semibold hover:bg-dark-border transition">S</button>
                                <button class="w-12 h-12 rounded-lg bg-dark-bg text-gray-400 font-semibold hover:bg-dark-border transition">D</button>
                            </div>
                        </div>
                    </div>

                    <!-- Contract Management -->
                    <div class="bg-dark-card border border-dark-border rounded-xl p-6">
                        <h3 class="text-xl font-bold mb-4">Gestión de Contratos</h3>

                        <div class="relative mb-4">
                            <span class="material-symbols-outlined absolute left-3 top-2.5 text-gray-400">search</span>
                            <input type="text" placeholder="Buscar contratos (ej. ES, NQ, BTC)" class="w-full bg-dark-bg text-white rounded-lg pl-10 pr-4 py-2 border border-dark-border focus:border-accent-cyan focus:outline-none"/>
                        </div>

                        <div class="space-y-2">
                            <div class="flex items-center justify-between p-3 bg-dark-bg rounded-lg">
                                <div>
                                    <p class="font-semibold">ES</p>
                                    <p class="text-sm text-gray-400">S&P 500 E-mini</p>
                                </div>
                                <button class="w-10 h-10 flex items-center justify-center bg-dark-card border border-dark-border rounded-lg hover:bg-accent-cyan hover:border-accent-cyan transition">
                                    <span class="material-symbols-outlined">add</span>
                                </button>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-dark-bg rounded-lg">
                                <div>
                                    <p class="font-semibold">NQ</p>
                                    <p class="text-sm text-gray-400">Nasdaq 100 E-mini</p>
                                </div>
                                <button class="w-10 h-10 flex items-center justify-center bg-dark-card border border-dark-border rounded-lg hover:bg-accent-cyan hover:border-accent-cyan transition">
                                    <span class="material-symbols-outlined">add</span>
                                </button>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-dark-bg rounded-lg">
                                <div>
                                    <p class="font-semibold">BTC</p>
                                    <p class="text-sm text-gray-400">Bitcoin</p>
                                </div>
                                <button class="w-10 h-10 flex items-center justify-center bg-dark-card border border-dark-border rounded-lg hover:bg-accent-cyan hover:border-accent-cyan transition">
                                    <span class="material-symbols-outlined">add</span>
                                </button>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-dark-bg rounded-lg">
                                <div>
                                    <p class="font-semibold">CL</p>
                                    <p class="text-sm text-gray-400">Crude Oil</p>
                                </div>
                                <button class="w-10 h-10 flex items-center justify-center bg-dark-card border border-dark-border rounded-lg hover:bg-accent-cyan hover:border-accent-cyan transition">
                                    <span class="material-symbols-outlined">add</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Column -->
                <div class="space-y-6">
                    <!-- Bot Status -->
                    <div class="bg-dark-card border border-dark-border rounded-xl p-6">
                        <h3 class="text-xl font-bold mb-4">Estado del Bot</h3>
                        <div class="flex items-center justify-between p-4 bg-dark-bg rounded-lg">
                            <p class="text-gray-300">El bot está actualmente inactivo.</p>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="bot-toggle" class="sr-only peer" onchange="toggleBot()">
                                <div class="w-14 h-8 bg-gray-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[4px] after:left-[4px] after:bg-white after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-accent-cyan"></div>
                            </label>
                        </div>
                    </div>

                    <!-- Bot Configuration -->
                    <div class="bg-dark-card border border-dark-border rounded-xl p-6">
                        <h3 class="text-xl font-bold mb-4">Configuración del Bot IA</h3>

                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <div>
                                <label class="text-gray-400 text-sm block mb-2">Timeframe</label>
                                <select class="w-full bg-dark-bg text-white rounded-lg px-4 py-2 border border-dark-border focus:border-accent-cyan focus:outline-none">
                                    <option>1 minuto</option>
                                    <option selected>5 minutos</option>
                                    <option>15 minutos</option>
                                    <option>1 hora</option>
                                </select>
                            </div>
                            <div>
                                <label class="text-gray-400 text-sm block mb-2">Señales en paralelo</label>
                                <input type="number" value="3" min="1" max="10" class="w-full bg-dark-bg text-white rounded-lg px-4 py-2 border border-dark-border focus:border-accent-cyan focus:outline-none"/>
                            </div>
                        </div>

                        <!-- Risk Management -->
                        <div class="mb-4">
                            <div class="flex items-center justify-between mb-3 cursor-pointer">
                                <h4 class="text-lg font-semibold">Gestión de Riesgo</h4>
                                <span class="material-symbols-outlined">expand_more</span>
                            </div>
                            <div class="space-y-3">
                                <div>
                                    <label class="text-gray-400 text-sm block mb-2">Stop Loss (%)</label>
                                    <input type="number" value="1.5" step="0.1" class="w-full bg-dark-bg text-white rounded-lg px-4 py-2 border border-dark-border focus:border-accent-cyan focus:outline-none"/>
                                </div>
                                <div>
                                    <label class="text-gray-400 text-sm block mb-2">Take Profit (%)</label>
                                    <input type="number" value="3.0" step="0.1" class="w-full bg-dark-bg text-white rounded-lg px-4 py-2 border border-dark-border focus:border-accent-cyan focus:outline-none"/>
                                </div>
                                <div>
                                    <label class="text-gray-400 text-sm block mb-2">Máximo Drawdown Diario ($)</label>
                                    <input type="number" value="500" step="50" class="w-full bg-dark-bg text-white rounded-lg px-4 py-2 border border-dark-border focus:border-accent-cyan focus:outline-none"/>
                                </div>
                            </div>
                        </div>

                        <!-- Strategy Parameters -->
                        <div>
                            <div class="flex items-center justify-between cursor-pointer">
                                <h4 class="text-lg font-semibold">Parámetros de Estrategia</h4>
                                <span class="material-symbols-outlined">expand_more</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Backtest Module -->
        <div id="module-backtest" class="module-hidden">
            <!-- Configuration -->
            <div class="bg-dark-card border border-dark-border rounded-xl p-6 mb-6">
                <h3 class="text-xl font-bold mb-4">Configuración de Backtest</h3>

                <div class="mb-4">
                    <label class="text-gray-400 text-sm block mb-3">Futuro</label>
                    <div class="flex gap-2">
                        <button class="px-6 py-2 rounded-lg bg-accent-cyan text-white font-medium">ES</button>
                        <button class="px-6 py-2 rounded-lg bg-dark-bg text-gray-400 hover:bg-dark-border transition">CL</button>
                        <button class="px-6 py-2 rounded-lg bg-dark-bg text-gray-400 hover:bg-dark-border transition">NQ</button>
                        <button class="px-6 py-2 rounded-lg bg-dark-bg text-gray-400 hover:bg-dark-border transition">NG</button>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label class="text-gray-400 text-sm block mb-2">Rango de fechas</label>
                        <input type="text" value="01 Ene 2023 - 31 Dic 2023" class="w-full bg-dark-bg text-white rounded-lg px-4 py-2 border border-dark-border focus:border-accent-cyan focus:outline-none"/>
                    </div>
                    <div>
                        <label class="text-gray-400 text-sm block mb-2">Estrategia</label>
                        <select class="w-full bg-dark-bg text-white rounded-lg px-4 py-2 border border-dark-border focus:border-accent-cyan focus:outline-none">
                            <option>Momentum Scalper v2.1</option>
                            <option>SMI + MACD Strategy</option>
                            <option>Bollinger Breakout</option>
                        </select>
                    </div>
                </div>

                <button class="bg-accent-cyan hover:bg-cyan-600 text-white font-bold py-2 px-6 rounded-lg transition flex items-center gap-2">
                    <span class="material-symbols-outlined">play_arrow</span>
                    Ejecutar Backtest
                </button>
            </div>

            <!-- Results -->
            <div id="backtest-results" class="bg-dark-card border border-dark-border rounded-xl p-6 mb-6 hidden">
                <h3 class="text-xl font-bold mb-4">Resultados del Backtest</h3>
                <p id="backtest-results-title" class="text-gray-400 text-sm mb-6"></p>

                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
                    <div>
                        <p class="text-gray-400 text-sm mb-1">Beneficio / Pérdida Total</p>
                        <p id="backtest-total-pnl" class="text-2xl font-bold">$0.00</p>
                    </div>
                    <div>
                        <p class="text-gray-400 text-sm mb-1">% de Acierto</p>
                        <p id="backtest-win-rate" class="text-2xl font-bold">0%</p>
                    </div>
                    <div>
                        <p class="text-gray-400 text-sm mb-1">Profit Factor</p>
                        <p id="backtest-profit-factor" class="text-2xl font-bold">0.00</p>
                    </div>
                    <div>
                        <p class="text-gray-400 text-sm mb-1">Drawdown Máximo</p>
                        <p id="backtest-max-drawdown" class="text-2xl font-bold text-red-500">0%</p>
                    </div>
                </div>

                <!-- Equity Curve -->
                <div>
                    <h4 class="text-lg font-semibold mb-4">Curva de Capital</h4>
                    <div class="bg-gradient-to-br from-cyan-500/20 to-blue-500/20 rounded-lg p-6" style="height: 250px;">
                        <canvas id="equity-curve"></canvas>
                    </div>
                </div>
            </div>

            <div id="backtest-no-results" class="bg-dark-card border border-dark-border rounded-xl p-6 mb-6">
                <div class="text-center py-8">
                    <span class="material-symbols-outlined text-6xl text-gray-600 mb-4">query_stats</span>
                    <h3 class="text-xl font-bold mb-2">No hay resultados de backtest</h3>
                    <p class="text-gray-400">Configure los parámetros arriba y presione "Ejecutar Backtest"</p>
                </div>
            </div>

            <!-- Trade History del Backtest -->
            <div id="backtest-trades" class="bg-dark-card border border-dark-border rounded-xl p-6 hidden">
                <h3 class="text-xl font-bold mb-4">Historial de Operaciones del Backtest</h3>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="text-left text-gray-400 text-sm border-b border-dark-border">
                                <th class="pb-4 font-medium">ACTIVO</th>
                                <th class="pb-4 font-medium">FECHA ENTRADA</th>
                                <th class="pb-4 font-medium">TIPO</th>
                                <th class="pb-4 font-medium">PRECIO ENTRADA</th>
                                <th class="pb-4 font-medium">PRECIO SALIDA</th>
                                <th class="pb-4 font-medium">RESULTADO ($)</th>
                                <th class="pb-4 font-medium">RESULTADO (%)</th>
                            </tr>
                        </thead>
                        <tbody id="backtest-trades-table" class="text-sm">
                            <tr>
                                <td colspan="7" class="py-8 text-center text-gray-400">No hay trades para mostrar</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Config Module -->
        <div id="module-config" class="module-hidden">
            <div class="max-w-4xl space-y-6">
                <!-- User Info -->
                <div class="bg-dark-card border border-dark-border rounded-xl p-6">
                    <h3 class="text-xl font-bold mb-2">Información de Usuario</h3>
                    <p class="text-gray-400 text-sm mb-4">Tu información de cuenta actual.</p>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="text-gray-300 text-sm font-medium block mb-2">Usuario Actual</label>
                            <input type="text" id="current-user-display" readonly class="w-full bg-dark-bg text-gray-400 rounded-lg px-4 py-3 border border-dark-border cursor-not-allowed" value="Cargando..."/>
                        </div>
                        <div>
                            <label class="text-gray-300 text-sm font-medium block mb-2">Email</label>
                            <input type="text" id="current-email-display" readonly class="w-full bg-dark-bg text-gray-400 rounded-lg px-4 py-3 border border-dark-border cursor-not-allowed" value="Cargando..."/>
                        </div>
                    </div>
                </div>

                <!-- TopstepX Connection -->
                <div class="bg-dark-card border border-dark-border rounded-xl p-6">
                    <h3 class="text-xl font-bold mb-2">Conexión a TopstepX</h3>
                    <p class="text-gray-400 text-sm mb-4">Configura tu API Key de TopstepX para operar.</p>

                    <div class="mb-4">
                        <label class="text-gray-300 text-sm font-medium block mb-2">Usuario de TopstepX</label>
                        <input type="text" id="config-topstep-username" placeholder="usuario@email.com" class="w-full bg-dark-bg text-white rounded-lg px-4 py-3 border border-dark-border focus:border-accent-cyan focus:outline-none"/>
                    </div>

                    <div class="mb-4">
                        <label class="text-gray-300 text-sm font-medium block mb-2">TopstepX API Key</label>
                        <div class="relative">
                            <input type="password" id="config-api-key" placeholder="••••••••••••••••" class="w-full bg-dark-bg text-white rounded-lg px-4 py-3 pr-12 border border-dark-border focus:border-accent-cyan focus:outline-none"/>
                            <button onclick="toggleApiKeyVisibility()" class="absolute right-3 top-3 text-gray-400 hover:text-white">
                                <span id="api-key-visibility-icon" class="material-symbols-outlined">visibility</span>
                            </button>
                        </div>
                    </div>

                    <!-- Estado de conexión -->
                    <div id="topstep-connection-indicator" class="mb-4 p-4 rounded-lg bg-dark-bg border border-dark-border hidden">
                        <div class="flex items-center gap-3">
                            <div id="topstep-status-icon" class="w-3 h-3 rounded-full bg-red-500"></div>
                            <div>
                                <p id="topstep-status-text" class="font-medium">Desconectado</p>
                                <p id="topstep-account-info" class="text-sm text-gray-400"></p>
                            </div>
                        </div>
                    </div>

                    <div class="flex gap-3">
                        <button onclick="testTopstepConnection()" class="bg-gray-700 hover:bg-gray-600 text-white font-medium py-2 px-6 rounded-lg transition">
                            Probar Conexión
                        </button>
                        <button id="topstep-connect-btn" onclick="toggleTopstepConnection()" class="bg-accent-cyan hover:bg-cyan-600 text-white font-medium py-2 px-6 rounded-lg transition">
                            <span id="topstep-connect-btn-text">Conectar</span>
                        </button>
                    </div>

                    <div id="topstep-connection-status" class="mt-4 p-4 rounded-lg hidden">
                        <p id="topstep-connection-message" class="text-sm"></p>
                    </div>
                </div>

                <!-- Notifications -->
                <div class="bg-dark-card border border-dark-border rounded-xl p-6">
                    <h3 class="text-xl font-bold mb-2">Notificaciones</h3>
                    <p class="text-gray-400 text-sm mb-4">Elige cómo y cuándo quieres recibir notificaciones.</p>

                    <div class="space-y-3">
                        <div class="flex items-center justify-between p-4 bg-dark-bg rounded-lg">
                            <div>
                                <p class="font-medium">Notificaciones por email</p>
                                <p class="text-sm text-gray-400">Recibe resúmenes y alertas importantes en tu correo.</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" checked class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-cyan"></div>
                            </label>
                        </div>

                        <div class="flex items-center justify-between p-4 bg-dark-bg rounded-lg">
                            <div>
                                <p class="font-medium">Notificaciones push</p>
                                <p class="text-sm text-gray-400">Recibe alertas en tiempo real en tu dispositivo.</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-cyan"></div>
                            </label>
                        </div>

                        <div class="flex items-center justify-between p-4 bg-dark-bg rounded-lg">
                            <div>
                                <p class="font-medium">Sonido en notificaciones</p>
                                <p class="text-sm text-gray-400">Activa alertas sonoras para operaciones importantes.</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" checked class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-cyan"></div>
                            </label>
                        </div>
                    </div>

                    <button class="mt-4 bg-accent-cyan hover:bg-cyan-600 text-white font-medium py-2 px-6 rounded-lg transition">
                        Guardar Cambios
                    </button>
                </div>

                <!-- Interface Preferences -->
                <div class="bg-dark-card border border-dark-border rounded-xl p-6">
                    <h3 class="text-xl font-bold mb-2">Preferencias de Interfaz</h3>
                    <p class="text-gray-400 text-sm mb-4">Personaliza la interfaz de la aplicación a tu gusto.</p>

                    <div class="mb-6">
                        <label class="text-gray-300 text-sm font-medium block mb-3">Tema</label>
                        <div class="grid grid-cols-3 gap-3">
                            <button class="p-4 bg-dark-bg border-2 border-dark-border rounded-lg hover:border-accent-cyan transition text-center">
                                <span class="material-symbols-outlined text-2xl mb-2">light_mode</span>
                                <p class="text-sm">Claro</p>
                            </button>
                            <button class="p-4 bg-dark-bg border-2 border-accent-cyan rounded-lg text-center">
                                <span class="material-symbols-outlined text-2xl mb-2">dark_mode</span>
                                <p class="text-sm">Oscuro</p>
                            </button>
                            <button class="p-4 bg-dark-bg border-2 border-dark-border rounded-lg hover:border-accent-cyan transition text-center">
                                <span class="material-symbols-outlined text-2xl mb-2">computer</span>
                                <p class="text-sm">Sistema</p>
                            </button>
                        </div>
                    </div>

                    <button class="bg-accent-cyan hover:bg-cyan-600 text-white font-medium py-2 px-6 rounded-lg transition">
                        Guardar Cambios
                    </button>
                </div>

                <!-- Bot Options & General Options -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-dark-card border border-dark-border rounded-xl p-6">
                        <h3 class="text-xl font-bold mb-4">Opciones del Bot</h3>
                        <p class="text-gray-400 text-sm mb-4">Ajusta los parámetros del bot de trading.</p>

                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="font-medium">Activar trading automático</p>
                                    <p class="text-sm text-gray-400">El bot operará automáticamente</p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" checked class="sr-only peer">
                                    <div class="w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-cyan"></div>
                                </label>
                            </div>

                            <div>
                                <label class="text-gray-300 text-sm font-medium block mb-2">Nivel de Riesgo</label>
                                <select class="w-full bg-dark-bg text-white rounded-lg px-4 py-2 border border-dark-border focus:border-accent-cyan focus:outline-none">
                                    <option>Conservador</option>
                                    <option selected>Moderado</option>
                                    <option>Agresivo</option>
                                </select>
                            </div>

                            <div>
                                <label class="text-gray-300 text-sm font-medium block mb-2">Estrategia Preferida</label>
                                <select class="w-full bg-dark-bg text-white rounded-lg px-4 py-2 border border-dark-border focus:border-accent-cyan focus:outline-none">
                                    <option selected>Momentum</option>
                                    <option>Mean Reversion</option>
                                    <option>Trend Following</option>
                                </select>
                            </div>
                        </div>

                        <button class="mt-4 w-full bg-accent-cyan hover:bg-cyan-600 text-white font-medium py-2 px-4 rounded-lg transition">
                            Guardar Cambios
                        </button>
                    </div>

                    <div class="bg-dark-card border border-dark-border rounded-xl p-6">
                        <h3 class="text-xl font-bold mb-4">Opciones Generales</h3>
                        <p class="text-gray-400 text-sm mb-4">Configuraciones generales de la aplicación.</p>

                        <div class="space-y-4">
                            <div>
                                <label class="text-gray-300 text-sm font-medium block mb-2">Idioma</label>
                                <select class="w-full bg-dark-bg text-white rounded-lg px-4 py-2 border border-dark-border focus:border-accent-cyan focus:outline-none">
                                    <option selected>Español</option>
                                    <option>English</option>
                                    <option>Português</option>
                                </select>
                            </div>

                            <div>
                                <label class="text-gray-300 text-sm font-medium block mb-2">Densidad de la interfaz</label>
                                <select class="w-full bg-dark-bg text-white rounded-lg px-4 py-2 border border-dark-border focus:border-accent-cyan focus:outline-none">
                                    <option>Compacta</option>
                                    <option selected>Cómoda</option>
                                    <option>Espaciosa</option>
                                </select>
                            </div>
                        </div>

                        <button class="mt-4 w-full bg-accent-cyan hover:bg-cyan-600 text-white font-medium py-2 px-4 rounded-lg transition">
                            Guardar Cambios
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>

<script src="notifications.js"></script>
<script src="app.js"></script>
</body>
</html>
